{% comment %}
This is a function to turn YML sidebar definitions into HTML lists.
Based on tip in http://hamishwillee.github.io/2014/11/13/jekyll-includes-are-functions/
To debug this file, use code such as the below, outside the liquid comment block - then inspect the source code. 
<!--
{{currentLevel|inspect}}
-->
{% endcomment %}
{% if include.item.contents %}
    <li>
        <a href="#">{{ include.item.title }}</a>
        <ul>
            {% comment %}
            Not checking for the level before the below recursion - could not figure out how to accurately compute the level. So, an infinite loop is possible!
            {% endcomment %}
            {% for subitem in include.item.contents %}
            {% include /functions/recursive_item_to_list.html item=subitem %}
            {% endfor %}
        </ul>
    </li>
{% else %}
    {% assign item_url_stripped = (include.item.url | remove: "index.html" | replace: ".md", ".html"%}
    {% assign list_item_css_class = "inactive" %}
    {% if page.url == item_url_stripped %}
        {% assign list_item_css_class = "active" %}
    {% else%}
        {% assign list_item_css_class = "inactive" %}
    {% endif %}
    {% if (include.item.url contains "http://") or  (include.item.url contains "https://") or (include.item.url contains "ftp://")%}
        <li><a href="{{include.item.url}}" target="_blank">{{include.item.title}}</a></li>
    {% elsif include.item.url contains "dir://" %}
        {% for site_page in site.pages %}
            {% assign dir_path = (include.item.url | remove: "dir://")%}
            {% if site_page.url contains dir_path%}
                {% if site_page.url == page.url %}
                    {% assign list_item_css_class = "active" %}
                {% else%}
                    {% assign list_item_css_class = "inactive" %}
                {% endif %}
                    <li class="{{list_item_css_class}}"><a href="{{site_page.url | prepend: site.baseurl}}">{{site_page.title}}</a></li>
            {% endif %}
        {% endfor %} <!-- page -->
    {% else%}
        <li class="{{list_item_css_class}}"><a href="{{include.item.url | prepend: site.baseurl}}">{{include.item.title}}</a></li>
    {% endif %}
{% endif %}

